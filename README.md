# Skystore - Интернет-магазин на Django

Веб-приложение интернет-магазина с каталогом товаров и блогом, построенное на Django с Bootstrap.

## 🚀 Функциональность

- Главная страница - информационный лендинг
- Страница контактов - контактная информация
- Адаптивный дизайн - работа на всех устройствах
- Навигация - меню между страницами
- 🆕 Каталог товаров - модели Product и Category
- 🆕 Админ-панель - управление товарами и категориями
- 🆕 PostgreSQL - профессиональная база данных
- 🆕 Загрузка изображений - для товаров через Pillow
- 🆕 Миграции БД - система управления схемой базы данных
- 🆕 Детальные страницы товаров
- 🆕 Динамическое отображение каталога
- 🆕 Блог с CRUD операциями - полное управление записями
- 🆕 Счетчик просмотров - автоматический учет просмотров статей
- 🆕 Фильтрация записей - показ только опубликованных статей
- 🆕 Умные перенаправления - после редактирования переход на просмотр статьи
- 🆕 Полный CRUD для товаров - создание, чтение, обновление, удаление
- 🆕 Защита от спама - валидация запрещенных слов в названиях и описаниях
- 🆕 Валидация изображений - проверка формата и размера загружаемых файлов
- 🆕 Валидация цен - защита от отрицательных и нулевых цен
- 🆕 Система модерации - управление публикацией продуктов
- 🆕 Владельцы продуктов - ограничение прав редактирования и удаления
- 🔥 **Низкоуровневое кэширование** - Redis-кэширование списков товаров и категорий
- 🔥 **Автоматическая инвалидация кэша** - при изменении данных
- 🔥 **Категории с slug** - SEO-дружественные URL
- 🔥 **Поиск и фильтрация** - товаров по названию и категориям
- 🔥 **Статистика магазина** - обзорная информация о товарах

## 🛠 Технологии

- Backend: Django 5.2+
- Frontend: Bootstrap 5.3
- Язык: Python 3.11+
- 🆕 База данных: PostgreSQL (ранее SQLite)
- 🆕 Pillow - обработка изображений
- 🆕 psycopg2 - драйвер PostgreSQL
- 🆕 python-dotenv - управление переменными окружения
- 🆕 Class-Based Views (CBV) - для блога и каталога
- 🆕 Django Forms - с кастомной валидацией
- 🔥 **Redis** - низкоуровневое кэширование
- 🔥 **django-redis** - интеграция кэша с Django
- 🔥 **slugify** - генерация SEO-URL для категорий

## 📁 Структура проекта

Django/
├── catalog/                 # Основное приложение
│   ├── management/commands/
│   │   ├── fill_products.py # 🆕 Кастомная команда
│   │   ├── create_moderator_group.py # 🆕 Создание группы модераторов
│   │   └── set_product_owners.py # 🆕 Установка владельцев продуктов
│   ├── fixtures/           # 🆕 Фикстуры данных
│   │   ├── category.json
│   │   └── product.json
│   ├── migrations/         # 🆕 Файлы миграций
│   ├── templates/catalog/
│   │   ├── base.html       # 🆕 Базовый шаблон
│   │   ├── includes/
│   │   │   └── header.html # 🆕 Подшаблон меню
│   │   ├── home.html
│   │   ├── contacts.html
│   │   ├── product_detail.html
│   │   ├── product_list.html      # 🆕 Список товаров
│   │   ├── product_form.html      # 🆕 Форма товара
│   │   └── product_confirm_delete.html # 🆕 Подтверждение удаления
│   ├── admin.py           # 🆕 Настройки админки
│   ├── models.py          # 🆕 Модели данных
│   ├── forms.py           # 🆕 Формы с валидацией
│   ├── views.py           # 🆕 CBV контроллеры
│   ├── cache.py           # 🔥 Менеджер кэширования CatalogCache
│   └── urls.py
├── blog/                   # 🆕 Приложение блога
│   ├── migrations/
│   ├── templates/blog/
│   │   ├── blogpost_list.html
│   │   ├── blogpost_detail.html
│   │   ├── blogpost_form.html
│   │   └── blogpost_confirm_delete.html
│   ├── admin.py
│   ├── models.py          # 🆕 Модель BlogPost
│   ├── views.py           # 🆕 CBV с кастомной логикой
│   └── urls.py
├── config/                 # Настройки проекта
│   ├── settings.py        # 🆕 Настройки PostgreSQL и Redis
│   ├── urls.py            # 🆕 Маршруты для медиафайлов и блога
│   └── ...
├── media/                 # 🆕 Папка для загружаемых файлов
├── .env                   # 🆕 Переменные окружения
├── requirements.txt       # 🆕 Зависимости проекта
└── manage.py

## 🔥 Новая архитектура кэширования

### CatalogCache - интеллектуальный менеджер кэша
- **Автоматическое кэширование** QuerySet'ов товаров и категорий
- **Разные TTL** для разных типов данных (5 мин - товары, 1 час - категории)
- **Автоматическая инвалидация** при изменении данных
- **Восстановление порядка** товаров из кэша

### Ключевые возможности кэширования
```python
# Получение товаров с кэшированием
products = cache_manager.get_products()
# Получение товаров по категории
category_products = cache_manager.get_products('elektronika')
# Получение статистики
stats = cache_manager.get_stats()
# Инвалидация кэша при изменениях
cache_manager.invalidate_product(product_id=1)

🆕 Модели данных

Category (обновлено)

· name - название категории
· slug - SEO-оптимизированный URL (автоматическая генерация)
· description - описание категории

Product

· name - название товара
· description - описание товара
· image - изображение товара
· category - связь с категорией (ForeignKey)
· price - цена товара
· created_at - дата создания
· updated_at - дата обновления
· is_published - статус публикации
· owner - владелец продукта (ForeignKey to User)

🆕 BlogPost

· title - заголовок статьи
· content - содержимое статьи
· preview - превью изображение
· created_at - дата создания
· is_published - признак публикации
· views_count - количество просмотров

⚡️ Быстрый старт
# Установка
git clone <repository-url>
cd Django
python -m venv .venv
.venv\Scripts\activate  # Windows
# source .venv/bin/activate  # Linux/Mac

# 🆕 Установка зависимостей
pip install -r requirements.txt

# 🔥 Запуск Redis (для кэширования)
redis-server

# 🆕 Настройка базы данных PostgreSQL
# Создайте БД и настройте .env файл

# Миграции и запуск
python manage.py migrate
python manage.py createsuperuser
python manage.py runserver

Откройте в браузере:

· http://127.0.0.1:8000/ - Главная страница
· http://127.0.0.1:8000/contacts/ - Контакты
· http://127.0.0.1:8000/admin/ - Админ-панель
· http://127.0.0.1:8000/products/ - Все товары (с кэшированием)
· http://127.0.0.1:8000/categories/ - Категории (с кэшированием)
· http://127.0.0.1:8000/category/elektronika/ - Товары категории
· http://127.0.0.1:8000/search/ - Поиск товаров
· http://127.0.0.1:8000/statistics/ - Статистика магазина

🔥 Новые маршруты с кэшированием

· /products/ - Список всех товаров (кэшируется)
· /categories/ - Список категорий (кэшируется)
· /category/<slug>/ - Товары категории (кэшируется)
· /search/ - Поиск товаров
· /statistics/ - Статистика магазина
· /cache/debug/ - Отладка кэша (для разработки)

🚀 Производительность с кэшированием

Без кэширования:

· Каждый запрос = обращение к БД
· Медленная загрузка при большом количестве товаров

С кэшированием:

· ✅ Первый запрос = БД + сохранение в Redis
· ✅ Последующие запросы = мгновенная загрузка из кэша
· ✅ Ускорение в 10-100 раз
· ✅ Снижение нагрузки на БД на 90%

📧 Настройка почтового сервера

Для Yandex
EMAIL_HOST = 'smtp.yandex.ru'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
EMAIL_HOST_USER = 'your_email@yandex.ru'
EMAIL_HOST_PASSWORD = 'app_password'

🛡 Безопасность

· ✅ Чувствительные данные в .env файле
· ✅ PostgreSQL вместо SQLite для продакшена
· ✅ Переменные окружения для настроек БД
· ✅ Валидация пользовательского ввода
· ✅ Защита от XSS и SQL-инъекций
· ✅ Безопасная загрузка файлов
· ✅ CSRF защита всех форм
· ✅ Хеширование паролей
· ✅ Ограничение доступа к защищенным страницам
· ✅ Проверка прав доступа - владельцы и модераторы
· ✅ Защита от несанкционированного редактирования - только владельцы

👨‍💻 Разработчик

Абрамов Александр

· GitHub: @1Abramov1

---

⭐️ Не забудьте поставить звезду, если проект был полезен!